import{S as P,i as V,s as $,k as I,a as y,l as b,m as M,c as S,h,n as D,b as g,G as d,H as A,o as F,e as L,J as z,q as p,r as m,u as E,K as G,L as J,M as N,N as q,O as K,y as U,z as W,A as j,g as Q,d as R,B as X}from"../chunks/index.46f63c5c.js";function w(f,e,s){const t=f.slice();return t[9]=e[s],t}function C(f,e,s){const t=f.slice();return t[12]=e[s],t}function Y(f){let e,s;return{c(){e=I("label"),s=p("No available MIDI inputs"),this.h()},l(t){e=b(t,"LABEL",{for:!0});var l=M(e);s=m(l,"No available MIDI inputs"),l.forEach(h),this.h()},h(){D(e,"for","midi-input-select")},m(t,l){g(t,e,l),d(e,s)},p:A,d(t){t&&h(e)}}}function Z(f){let e,s,t,l,c,n,a=f[2],r=[];for(let i=0;i<a.length;i+=1)r[i]=O(C(f,a,i));return{c(){e=I("label"),s=p("Select MIDI Input:"),t=y(),l=I("select");for(let i=0;i<r.length;i+=1)r[i].c();this.h()},l(i){e=b(i,"LABEL",{for:!0});var _=M(e);s=m(_,"Select MIDI Input:"),_.forEach(h),t=S(i),l=b(i,"SELECT",{});var o=M(l);for(let u=0;u<r.length;u+=1)r[u].l(o);o.forEach(h),this.h()},h(){D(e,"for","midi-input-select"),f[0].id===void 0&&J(()=>f[4].call(l))},m(i,_){g(i,e,_),d(e,s),g(i,t,_),g(i,l,_);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(l,null);N(l,f[0].id,!0),c||(n=[q(l,"change",f[4]),q(l,"change",f[3])],c=!0)},p(i,_){if(_&4){a=i[2];let o;for(o=0;o<a.length;o+=1){const u=C(i,a,o);r[o]?r[o].p(u,_):(r[o]=O(u),r[o].c(),r[o].m(l,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=a.length}_&5&&N(l,i[0].id)},d(i){i&&h(e),i&&h(t),i&&h(l),z(r,i),c=!1,K(n)}}}function O(f){let e,s=f[12].name+"",t,l;return{c(){e=I("option"),t=p(s),this.h()},l(c){e=b(c,"OPTION",{});var n=M(e);t=m(n,s),n.forEach(h),this.h()},h(){e.__value=l=f[12].id,e.value=e.__value},m(c,n){g(c,e,n),d(e,t)},p(c,n){n&4&&s!==(s=c[12].name+"")&&E(t,s),n&4&&l!==(l=c[12].id)&&(e.__value=l,e.value=e.__value)},d(c){c&&h(e)}}}function T(f){let e,s=f[1],t=[];for(let l=0;l<s.length;l+=1)t[l]=B(w(f,s,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=L()},l(l){for(let c=0;c<t.length;c+=1)t[c].l(l);e=L()},m(l,c){for(let n=0;n<t.length;n+=1)t[n]&&t[n].m(l,c);g(l,e,c)},p(l,c){if(c&2){s=l[1];let n;for(n=0;n<s.length;n+=1){const a=w(l,s,n);t[n]?t[n].p(a,c):(t[n]=B(a),t[n].c(),t[n].m(e.parentNode,e))}for(;n<t.length;n+=1)t[n].d(1);t.length=s.length}},d(l){z(t,l),l&&h(e)}}}function B(f){let e,s,t=f[9].note+"",l,c,n=f[9].timestamp+"",a,r,i=f[9].velocity+"",_;return{c(){e=I("li"),s=p("Note: "),l=p(t),c=p(", Timestamp: "),a=p(n),r=p(", Velocity: "),_=p(i)},l(o){e=b(o,"LI",{});var u=M(e);s=m(u,"Note: "),l=m(u,t),c=m(u,", Timestamp: "),a=m(u,n),r=m(u,", Velocity: "),_=m(u,i),u.forEach(h)},m(o,u){g(o,e,u),d(e,s),d(e,l),d(e,c),d(e,a),d(e,r),d(e,_)},p(o,u){u&2&&t!==(t=o[9].note+"")&&E(l,t),u&2&&n!==(n=o[9].timestamp+"")&&E(a,n),u&2&&i!==(i=o[9].velocity+"")&&E(_,i)},d(o){o&&h(e)}}}function x(f){let e,s,t;function l(r,i){var _;return(_=r[0])!=null&&_.id?Z:Y}let c=l(f),n=c(f),a=f[1].length>0&&T(f);return{c(){e=I("div"),n.c(),s=y(),t=I("ul"),a&&a.c(),this.h()},l(r){e=b(r,"DIV",{});var i=M(e);n.l(i),s=S(i),t=b(i,"UL",{id:!0});var _=M(t);a&&a.l(_),_.forEach(h),i.forEach(h),this.h()},h(){D(t,"id","note-list")},m(r,i){g(r,e,i),n.m(e,null),d(e,s),d(e,t),a&&a.m(t,null)},p(r,[i]){c===(c=l(r))&&n?n.p(r,i):(n.d(1),n=c(r),n&&(n.c(),n.m(e,s))),r[1].length>0?a?a.p(r,i):(a=T(r),a.c(),a.m(t,null)):a&&(a.d(1),a=null)},i:A,o:A,d(r){r&&h(e),n.d(),a&&a.d()}}}function ee(f,e,s){let t,l=null,c=[],n=[];const a=o=>{console.log("handleMidiMessage",o);const u=o.data[0],v=o.timeStamp;if(o.data[1],o.data.length>2&&o.data[2],u<=144&&u<=159){const k=o.data[1],H=o.data[2];s(1,c=[{note:k,timestamp:v,velocity:H},...c])}},r=o=>{console.log("updateSelectedInput",o),l!==o&&(l&&l.removeEventListener("midimessage",a),s(0,l=o),l.addEventListener("midimessage",a))},i=o=>{console.log("handleSelectChange",o);const u=o.target.value,v=t.inputs.get(u);v&&r(v)};F(async()=>{if(console.log("onMount"),!navigator.requestMIDIAccess){const o="WebMidi API not supported on this browser.";alert(o),console.log(o);return}try{console.log("requestMidi"),t=await navigator.requestMIDIAccess(),t.onstatechange=o=>{console.log("midiAccess",t),console.log("midiAccess.inputs",t.inputs),console.log("midiAccess.inputs.values",t.inputs.values()),console.log("midiAccess.inputs.values.array",Array.from(t.inputs.values())),console.log("midiAccess.inputs.0",t.inputs.get("0")),console.log({event:o});let u=[];t.inputs.forEach(v=>{u.push(v)}),console.log("midiAccess!.inputs",t.inputs),console.log("inputs",u),u.length>0?(s(2,n=u.map((v,k)=>({id:v.id,name:`${k} ${v.name}`}))),(!l||!u.includes(l))&&r(u[0])):(s(2,n=[{id:"",name:"No available MIDI inputs"}]),s(0,l=null))},t.onstatechange(),window.leoo=t}catch(o){console.error("Failed to initialize MIDI: ",o)}});function _(){l.id=G(this),s(0,l),s(2,n)}return[l,c,n,i,_]}class te extends P{constructor(e){super(),V(this,e,ee,x,$,{})}}function le(f){let e,s,t,l,c;return l=new te({}),{c(){e=I("h1"),s=p("Svelte MIDI Input"),t=y(),U(l.$$.fragment)},l(n){e=b(n,"H1",{});var a=M(e);s=m(a,"Svelte MIDI Input"),a.forEach(h),t=S(n),W(l.$$.fragment,n)},m(n,a){g(n,e,a),d(e,s),g(n,t,a),j(l,n,a),c=!0},p:A,i(n){c||(Q(l.$$.fragment,n),c=!0)},o(n){R(l.$$.fragment,n),c=!1},d(n){n&&h(e),n&&h(t),X(l,n)}}}class oe extends P{constructor(e){super(),V(this,e,null,le,$,{})}}export{oe as default};
