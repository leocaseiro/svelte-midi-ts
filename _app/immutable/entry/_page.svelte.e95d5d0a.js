import{S as U,i as F,s as G,k as b,a as D,l as E,m as M,h as d,c as S,n as N,b as I,G as p,H as y,J as q,o as J,q as g,r as v,u as L,e as O,K,L as W,M as T,N as w,O as j,y as Q,z as R,A as X,g as Y,d as Z,B as x}from"../chunks/index.46f63c5c.js";function B(r,e,o){const l=r.slice();return l[8]=e[o],l}function C(r,e,o){const l=r.slice();return l[11]=e[o],l}function P(r,e,o){const l=r.slice();return l[11]=e[o],l}function V(r){let e,o=r[11].id+"",l,t,c=r[11].name+"",n;return{c(){e=b("li"),l=g(o),t=g(" - "),n=g(c)},l(s){e=E(s,"LI",{});var u=M(e);l=v(u,o),t=v(u," - "),n=v(u,c),u.forEach(d)},m(s,u){I(s,e,u),p(e,l),p(e,t),p(e,n)},p(s,u){u&4&&o!==(o=s[11].id+"")&&L(l,o),u&4&&c!==(c=s[11].name+"")&&L(n,c)},d(s){s&&d(e)}}}function ee(r){let e,o;return{c(){e=b("label"),o=g("No available MIDI inputs"),this.h()},l(l){e=E(l,"LABEL",{for:!0});var t=M(e);o=v(t,"No available MIDI inputs"),t.forEach(d),this.h()},h(){N(e,"for","midi-input-select")},m(l,t){I(l,e,t),p(e,o)},p:y,d(l){l&&d(e)}}}function te(r){let e,o,l,t,c,n,s=r[2],u=[];for(let f=0;f<s.length;f+=1)u[f]=$(C(r,s,f));return{c(){e=b("label"),o=g("Select MIDI Input:"),l=D(),t=b("select");for(let f=0;f<u.length;f+=1)u[f].c();this.h()},l(f){e=E(f,"LABEL",{for:!0});var _=M(e);o=v(_,"Select MIDI Input:"),_.forEach(d),l=S(f),t=E(f,"SELECT",{});var i=M(t);for(let a=0;a<u.length;a+=1)u[a].l(i);i.forEach(d),this.h()},h(){N(e,"for","midi-input-select"),r[0].id===void 0&&W(()=>r[4].call(t))},m(f,_){I(f,e,_),p(e,o),I(f,l,_),I(f,t,_);for(let i=0;i<u.length;i+=1)u[i]&&u[i].m(t,null);T(t,r[0].id,!0),c||(n=[w(t,"change",r[4]),w(t,"change",r[3])],c=!0)},p(f,_){if(_&4){s=f[2];let i;for(i=0;i<s.length;i+=1){const a=C(f,s,i);u[i]?u[i].p(a,_):(u[i]=$(a),u[i].c(),u[i].m(t,null))}for(;i<u.length;i+=1)u[i].d(1);u.length=s.length}_&5&&T(t,f[0].id)},d(f){f&&d(e),f&&d(l),f&&d(t),q(u,f),c=!1,j(n)}}}function $(r){let e,o=r[11].name+"",l,t;return{c(){e=b("option"),l=g(o),this.h()},l(c){e=E(c,"OPTION",{});var n=M(e);l=v(n,o),n.forEach(d),this.h()},h(){e.__value=t=r[11].id,e.value=e.__value},m(c,n){I(c,e,n),p(e,l)},p(c,n){n&4&&o!==(o=c[11].name+"")&&L(l,o),n&4&&t!==(t=c[11].id)&&(e.__value=t,e.value=e.__value)},d(c){c&&d(e)}}}function z(r){let e,o=r[1],l=[];for(let t=0;t<o.length;t+=1)l[t]=H(B(r,o,t));return{c(){for(let t=0;t<l.length;t+=1)l[t].c();e=O()},l(t){for(let c=0;c<l.length;c+=1)l[c].l(t);e=O()},m(t,c){for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(t,c);I(t,e,c)},p(t,c){if(c&2){o=t[1];let n;for(n=0;n<o.length;n+=1){const s=B(t,o,n);l[n]?l[n].p(s,c):(l[n]=H(s),l[n].c(),l[n].m(e.parentNode,e))}for(;n<l.length;n+=1)l[n].d(1);l.length=o.length}},d(t){q(l,t),t&&d(e)}}}function H(r){let e,o,l=r[8].note+"",t,c,n=r[8].timestamp+"",s,u,f=r[8].velocity+"",_;return{c(){e=b("li"),o=g("Note: "),t=g(l),c=g(", Timestamp: "),s=g(n),u=g(", Velocity: "),_=g(f)},l(i){e=E(i,"LI",{});var a=M(e);o=v(a,"Note: "),t=v(a,l),c=v(a,", Timestamp: "),s=v(a,n),u=v(a,", Velocity: "),_=v(a,f),a.forEach(d)},m(i,a){I(i,e,a),p(e,o),p(e,t),p(e,c),p(e,s),p(e,u),p(e,_)},p(i,a){a&2&&l!==(l=i[8].note+"")&&L(t,l),a&2&&n!==(n=i[8].timestamp+"")&&L(s,n),a&2&&f!==(f=i[8].velocity+"")&&L(_,f)},d(i){i&&d(e)}}}function le(r){let e,o,l,t,c,n=r[2],s=[];for(let a=0;a<n.length;a+=1)s[a]=V(P(r,n,a));function u(a,m){var h;return(h=a[0])!=null&&h.id?te:ee}let f=u(r),_=f(r),i=r[1].length>0&&z(r);return{c(){e=b("div"),o=b("ul");for(let a=0;a<s.length;a+=1)s[a].c();l=D(),_.c(),t=D(),c=b("ul"),i&&i.c(),this.h()},l(a){e=E(a,"DIV",{});var m=M(e);o=E(m,"UL",{});var h=M(o);for(let A=0;A<s.length;A+=1)s[A].l(h);h.forEach(d),l=S(m),_.l(m),t=S(m),c=E(m,"UL",{id:!0});var k=M(c);i&&i.l(k),k.forEach(d),m.forEach(d),this.h()},h(){N(c,"id","note-list")},m(a,m){I(a,e,m),p(e,o);for(let h=0;h<s.length;h+=1)s[h]&&s[h].m(o,null);p(e,l),_.m(e,null),p(e,t),p(e,c),i&&i.m(c,null)},p(a,[m]){if(m&4){n=a[2];let h;for(h=0;h<n.length;h+=1){const k=P(a,n,h);s[h]?s[h].p(k,m):(s[h]=V(k),s[h].c(),s[h].m(o,null))}for(;h<s.length;h+=1)s[h].d(1);s.length=n.length}f===(f=u(a))&&_?_.p(a,m):(_.d(1),_=f(a),_&&(_.c(),_.m(e,t))),a[1].length>0?i?i.p(a,m):(i=z(a),i.c(),i.m(c,null)):i&&(i.d(1),i=null)},i:y,o:y,d(a){a&&d(e),q(s,a),_.d(),i&&i.d()}}}function ne(r,e,o){let l,t=null,c=[],n=[];const s=i=>{const a=i.data[0],m=i.timeStamp;if(i.data[1],i.data.length>2&&i.data[2],a<=144&&a<=159){const h=i.data[1],k=i.data[2];o(1,c=[{note:h,timestamp:m,velocity:k},...c])}},u=i=>{t!==i&&(t&&t.removeEventListener("midimessage",s),o(0,t=i),t.addEventListener("midimessage",s))},f=i=>{const a=i.target.value,m=l.inputs.get(a);m&&u(m)};J(async()=>{if(!navigator.requestMIDIAccess){const i="WebMidi API not supported on this browser.";alert(i),console.log(i);return}try{l=await navigator.requestMIDIAccess(),l.onstatechange=i=>{const a=Array.from(l.inputs.values());a.length>0?(o(2,n=a.map((m,h)=>({id:m.id,name:`${h} ${m.name}`}))),(!t||!a.includes(t))&&u(a[0])):(o(2,n=[{id:"",name:"No available MIDI inputs"}]),o(0,t=null))},l.onstatechange()}catch(i){console.error("Failed to initialize MIDI: ",i)}});function _(){t.id=K(this),o(0,t),o(2,n)}return[t,c,n,f,_]}class ie extends U{constructor(e){super(),F(this,e,ne,le,G,{})}}function ae(r){let e,o,l,t,c;return t=new ie({}),{c(){e=b("h1"),o=g("Svelte MIDI Input"),l=D(),Q(t.$$.fragment)},l(n){e=E(n,"H1",{});var s=M(e);o=v(s,"Svelte MIDI Input"),s.forEach(d),l=S(n),R(t.$$.fragment,n)},m(n,s){I(n,e,s),p(e,o),I(n,l,s),X(t,n,s),c=!0},p:y,i(n){c||(Y(t.$$.fragment,n),c=!0)},o(n){Z(t.$$.fragment,n),c=!1},d(n){n&&d(e),n&&d(l),x(t,n)}}}class se extends U{constructor(e){super(),F(this,e,null,ae,G,{})}}export{se as default};
