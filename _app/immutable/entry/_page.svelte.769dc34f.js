import{S as K,i as W,s as $,k,q as b,a as y,l as L,m as S,r as E,c as A,h as g,n as T,b as M,G as I,u as D,H as O,J as w,o as j,e as B,K as Q,L as R,M as C,N as J,O as X,y as Y,z as Z,A as x,g as ee,d as te,B as le}from"../chunks/index.46f63c5c.js";function P(r,e,i){const l=r.slice();return l[9]=e[i],l}function V(r,e,i){const l=r.slice();return l[12]=e[i],l}function z(r,e,i){const l=r.slice();return l[12]=e[i],l}function H(r){let e,i=r[12].id+"",l,t,a=r[12].name+"",n;return{c(){e=k("li"),l=b(i),t=b(" - "),n=b(a)},l(f){e=L(f,"LI",{});var s=S(e);l=E(s,i),t=E(s," - "),n=E(s,a),s.forEach(g)},m(f,s){M(f,e,s),I(e,l),I(e,t),I(e,n)},p(f,s){s&4&&i!==(i=f[12].id+"")&&D(l,i),s&4&&a!==(a=f[12].name+"")&&D(n,a)},d(f){f&&g(e)}}}function ne(r){let e,i;return{c(){e=k("label"),i=b("No available MIDI inputs"),this.h()},l(l){e=L(l,"LABEL",{for:!0});var t=S(e);i=E(t,"No available MIDI inputs"),t.forEach(g),this.h()},h(){T(e,"for","midi-input-select")},m(l,t){M(l,e,t),I(e,i)},p:O,d(l){l&&g(e)}}}function ie(r){let e,i,l,t,a,n,f=r[2],s=[];for(let c=0;c<f.length;c+=1)s[c]=U(V(r,f,c));return{c(){e=k("label"),i=b("Select MIDI Input:"),l=y(),t=k("select");for(let c=0;c<s.length;c+=1)s[c].c();this.h()},l(c){e=L(c,"LABEL",{for:!0});var u=S(e);i=E(u,"Select MIDI Input:"),u.forEach(g),l=A(c),t=L(c,"SELECT",{});var _=S(t);for(let o=0;o<s.length;o+=1)s[o].l(_);_.forEach(g),this.h()},h(){T(e,"for","midi-input-select"),r[0].id===void 0&&R(()=>r[5].call(t))},m(c,u){M(c,e,u),I(e,i),M(c,l,u),M(c,t,u);for(let _=0;_<s.length;_+=1)s[_]&&s[_].m(t,null);C(t,r[0].id,!0),a||(n=[J(t,"change",r[5]),J(t,"change",r[4])],a=!0)},p(c,u){if(u&4){f=c[2];let _;for(_=0;_<f.length;_+=1){const o=V(c,f,_);s[_]?s[_].p(o,u):(s[_]=U(o),s[_].c(),s[_].m(t,null))}for(;_<s.length;_+=1)s[_].d(1);s.length=f.length}u&5&&C(t,c[0].id)},d(c){c&&g(e),c&&g(l),c&&g(t),w(s,c),a=!1,X(n)}}}function U(r){let e,i=r[12].name+"",l,t;return{c(){e=k("option"),l=b(i),this.h()},l(a){e=L(a,"OPTION",{});var n=S(e);l=E(n,i),n.forEach(g),this.h()},h(){e.__value=t=r[12].id,e.value=e.__value},m(a,n){M(a,e,n),I(e,l)},p(a,n){n&4&&i!==(i=a[12].name+"")&&D(l,i),n&4&&t!==(t=a[12].id)&&(e.__value=t,e.value=e.__value)},d(a){a&&g(e)}}}function F(r){let e,i=r[1],l=[];for(let t=0;t<i.length;t+=1)l[t]=G(P(r,i,t));return{c(){for(let t=0;t<l.length;t+=1)l[t].c();e=B()},l(t){for(let a=0;a<l.length;a+=1)l[a].l(t);e=B()},m(t,a){for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(t,a);M(t,e,a)},p(t,a){if(a&2){i=t[1];let n;for(n=0;n<i.length;n+=1){const f=P(t,i,n);l[n]?l[n].p(f,a):(l[n]=G(f),l[n].c(),l[n].m(e.parentNode,e))}for(;n<l.length;n+=1)l[n].d(1);l.length=i.length}},d(t){w(l,t),t&&g(e)}}}function G(r){let e,i,l=r[9].note+"",t,a,n=r[9].timestamp+"",f,s,c=r[9].velocity+"",u;return{c(){e=k("li"),i=b("Note: "),t=b(l),a=b(", Timestamp: "),f=b(n),s=b(", Velocity: "),u=b(c)},l(_){e=L(_,"LI",{});var o=S(e);i=E(o,"Note: "),t=E(o,l),a=E(o,", Timestamp: "),f=E(o,n),s=E(o,", Velocity: "),u=E(o,c),o.forEach(g)},m(_,o){M(_,e,o),I(e,i),I(e,t),I(e,a),I(e,f),I(e,s),I(e,u)},p(_,o){o&2&&l!==(l=_[9].note+"")&&D(t,l),o&2&&n!==(n=_[9].timestamp+"")&&D(f,n),o&2&&c!==(c=_[9].velocity+"")&&D(u,c)},d(_){_&&g(e)}}}function ae(r){let e,i=JSON.stringify(r[3])+"",l,t,a,n,f,s,c=r[2],u=[];for(let h=0;h<c.length;h+=1)u[h]=H(z(r,c,h));function _(h,v){var d;return(d=h[0])!=null&&d.id?ie:ne}let o=_(r),p=o(r),m=r[1].length>0&&F(r);return{c(){e=k("div"),l=b(i),t=y(),a=k("ul");for(let h=0;h<u.length;h+=1)u[h].c();n=y(),p.c(),f=y(),s=k("ul"),m&&m.c(),this.h()},l(h){e=L(h,"DIV",{});var v=S(e);l=E(v,i),t=A(v),a=L(v,"UL",{});var d=S(a);for(let q=0;q<u.length;q+=1)u[q].l(d);d.forEach(g),n=A(v),p.l(v),f=A(v),s=L(v,"UL",{id:!0});var N=S(s);m&&m.l(N),N.forEach(g),v.forEach(g),this.h()},h(){T(s,"id","note-list")},m(h,v){M(h,e,v),I(e,l),I(e,t),I(e,a);for(let d=0;d<u.length;d+=1)u[d]&&u[d].m(a,null);I(e,n),p.m(e,null),I(e,f),I(e,s),m&&m.m(s,null)},p(h,[v]){if(v&8&&i!==(i=JSON.stringify(h[3])+"")&&D(l,i),v&4){c=h[2];let d;for(d=0;d<c.length;d+=1){const N=z(h,c,d);u[d]?u[d].p(N,v):(u[d]=H(N),u[d].c(),u[d].m(a,null))}for(;d<u.length;d+=1)u[d].d(1);u.length=c.length}o===(o=_(h))&&p?p.p(h,v):(p.d(1),p=o(h),p&&(p.c(),p.m(e,f))),h[1].length>0?m?m.p(h,v):(m=F(h),m.c(),m.m(s,null)):m&&(m.d(1),m=null)},i:O,o:O,d(h){h&&g(e),w(u,h),p.d(),m&&m.d()}}}function oe(r,e,i){let l,t=null,a=[],n=[],f=[];const s=o=>{const p=o.data[0],m=o.timeStamp;if(o.data[1],o.data.length>2&&o.data[2],p<=144&&p<=159){const h=o.data[1],v=o.data[2];i(1,a=[{note:h,timestamp:m,velocity:v},...a])}},c=o=>{t!==o&&(t&&t.removeEventListener("midimessage",s),i(0,t=o),t.addEventListener("midimessage",s))},u=o=>{const p=o.target.value,m=l.inputs.get(p);m&&c(m)};j(async()=>{if(!navigator.requestMIDIAccess){const o="WebMidi API not supported on this browser.";alert(o),console.log(o);return}try{l=await navigator.requestMIDIAccess(),l.onstatechange=o=>{const p=Array.from(l.inputs.values());i(3,f=p),p.length>0?(i(2,n=p.map((m,h)=>({id:m.id,name:`${h} ${m.name}`}))),(!t||!p.includes(t))&&c(p[0])):(i(2,n=[{id:"",name:"No available MIDI inputs"}]),i(0,t=null))},l.onstatechange()}catch(o){console.error("Failed to initialize MIDI: ",o)}});function _(){t.id=Q(this),i(0,t),i(2,n)}return[t,a,n,f,u,_]}class se extends K{constructor(e){super(),W(this,e,oe,ae,$,{})}}function ce(r){let e,i,l,t,a;return t=new se({}),{c(){e=k("h1"),i=b("Svelte MIDI Input"),l=y(),Y(t.$$.fragment)},l(n){e=L(n,"H1",{});var f=S(e);i=E(f,"Svelte MIDI Input"),f.forEach(g),l=A(n),Z(t.$$.fragment,n)},m(n,f){M(n,e,f),I(e,i),M(n,l,f),x(t,n,f),a=!0},p:O,i(n){a||(ee(t.$$.fragment,n),a=!0)},o(n){te(t.$$.fragment,n),a=!1},d(n){n&&g(e),n&&g(l),le(t,n)}}}class fe extends K{constructor(e){super(),W(this,e,null,ce,$,{})}}export{fe as default};
