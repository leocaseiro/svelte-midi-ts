import{S as P,i as V,s as $,k as v,a as D,l as b,m as M,c as y,h,n as L,b as g,G as d,H as k,o as F,e as N,J as z,q as m,r as p,u as E,K as G,L as J,M as A,N as q,O as K,y as U,z as W,A as j,g as Q,d as R,B as X}from"../chunks/index.46f63c5c.js";function w(f,e,i){const n=f.slice();return n[9]=e[i],n}function C(f,e,i){const n=f.slice();return n[12]=e[i],n}function Y(f){let e,i;return{c(){e=v("label"),i=m("No available MIDI inputs"),this.h()},l(n){e=b(n,"LABEL",{for:!0});var t=M(e);i=p(t,"No available MIDI inputs"),t.forEach(h),this.h()},h(){L(e,"for","midi-input-select")},m(n,t){g(n,e,t),d(e,i)},p:k,d(n){n&&h(e)}}}function Z(f){let e,i,n,t,c,l,s=f[2],r=[];for(let a=0;a<s.length;a+=1)r[a]=O(C(f,s,a));return{c(){e=v("label"),i=m("Select MIDI Input:"),n=D(),t=v("select");for(let a=0;a<r.length;a+=1)r[a].c();this.h()},l(a){e=b(a,"LABEL",{for:!0});var _=M(e);i=p(_,"Select MIDI Input:"),_.forEach(h),n=y(a),t=b(a,"SELECT",{});var o=M(t);for(let u=0;u<r.length;u+=1)r[u].l(o);o.forEach(h),this.h()},h(){L(e,"for","midi-input-select"),f[0].id===void 0&&J(()=>f[4].call(t))},m(a,_){g(a,e,_),d(e,i),g(a,n,_),g(a,t,_);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(t,null);A(t,f[0].id,!0),c||(l=[q(t,"change",f[4]),q(t,"change",f[3])],c=!0)},p(a,_){if(_&4){s=a[2];let o;for(o=0;o<s.length;o+=1){const u=C(a,s,o);r[o]?r[o].p(u,_):(r[o]=O(u),r[o].c(),r[o].m(t,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=s.length}_&5&&A(t,a[0].id)},d(a){a&&h(e),a&&h(n),a&&h(t),z(r,a),c=!1,K(l)}}}function O(f){let e,i=f[12].name+"",n,t;return{c(){e=v("option"),n=m(i),this.h()},l(c){e=b(c,"OPTION",{});var l=M(e);n=p(l,i),l.forEach(h),this.h()},h(){e.__value=t=f[12].id,e.value=e.__value},m(c,l){g(c,e,l),d(e,n)},p(c,l){l&4&&i!==(i=c[12].name+"")&&E(n,i),l&4&&t!==(t=c[12].id)&&(e.__value=t,e.value=e.__value)},d(c){c&&h(e)}}}function T(f){let e,i=f[1],n=[];for(let t=0;t<i.length;t+=1)n[t]=B(w(f,i,t));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=N()},l(t){for(let c=0;c<n.length;c+=1)n[c].l(t);e=N()},m(t,c){for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(t,c);g(t,e,c)},p(t,c){if(c&2){i=t[1];let l;for(l=0;l<i.length;l+=1){const s=w(t,i,l);n[l]?n[l].p(s,c):(n[l]=B(s),n[l].c(),n[l].m(e.parentNode,e))}for(;l<n.length;l+=1)n[l].d(1);n.length=i.length}},d(t){z(n,t),t&&h(e)}}}function B(f){let e,i,n=f[9].note+"",t,c,l=f[9].timestamp+"",s,r,a=f[9].velocity+"",_;return{c(){e=v("li"),i=m("Note: "),t=m(n),c=m(", Timestamp: "),s=m(l),r=m(", Velocity: "),_=m(a)},l(o){e=b(o,"LI",{});var u=M(e);i=p(u,"Note: "),t=p(u,n),c=p(u,", Timestamp: "),s=p(u,l),r=p(u,", Velocity: "),_=p(u,a),u.forEach(h)},m(o,u){g(o,e,u),d(e,i),d(e,t),d(e,c),d(e,s),d(e,r),d(e,_)},p(o,u){u&2&&n!==(n=o[9].note+"")&&E(t,n),u&2&&l!==(l=o[9].timestamp+"")&&E(s,l),u&2&&a!==(a=o[9].velocity+"")&&E(_,a)},d(o){o&&h(e)}}}function x(f){let e,i,n;function t(r,a){var _;return(_=r[0])!=null&&_.id?Z:Y}let c=t(f),l=c(f),s=f[1].length>0&&T(f);return{c(){e=v("div"),l.c(),i=D(),n=v("ul"),s&&s.c(),this.h()},l(r){e=b(r,"DIV",{});var a=M(e);l.l(a),i=y(a),n=b(a,"UL",{id:!0});var _=M(n);s&&s.l(_),_.forEach(h),a.forEach(h),this.h()},h(){L(n,"id","note-list")},m(r,a){g(r,e,a),l.m(e,null),d(e,i),d(e,n),s&&s.m(n,null)},p(r,[a]){c===(c=t(r))&&l?l.p(r,a):(l.d(1),l=c(r),l&&(l.c(),l.m(e,i))),r[1].length>0?s?s.p(r,a):(s=T(r),s.c(),s.m(n,null)):s&&(s.d(1),s=null)},i:k,o:k,d(r){r&&h(e),l.d(),s&&s.d()}}}function ee(f,e,i){let n,t=null,c=[],l=[];const s=o=>{console.log("handleMidiMessage",o);const u=o.data[0],I=o.timeStamp;if(o.data[1],o.data.length>2&&o.data[2],u<=144&&u<=159){const S=o.data[1],H=o.data[2];i(1,c=[{note:S,timestamp:I,velocity:H},...c])}},r=o=>{console.log("updateSelectedInput",o),t!==o&&(t&&t.removeEventListener("midimessage",s),i(0,t=o),t.addEventListener("midimessage",s))},a=o=>{console.log("handleSelectChange",o);const u=o.target.value,I=n.inputs.get(u);I&&r(I)};F(async()=>{if(console.log("onMount"),!navigator.requestMIDIAccess){const o="WebMidi API not supported on this browser.";alert(o),console.log(o);return}try{console.log("requestMidi"),n=await navigator.requestMIDIAccess(),n.onstatechange=o=>{let u=[];n.inputs.forEach(I=>{u.push(I)}),console.log("inputs",u),u.length>0?(i(2,l=u.map((I,S)=>({id:I.id,name:`${S} ${I.name}`}))),(!t||!u.includes(t))&&r(u[0])):(i(2,l=[{id:"",name:"No available MIDI inputs"}]),i(0,t=null))},n.onstatechange(),window.leoo=n}catch(o){console.error("Failed to initialize MIDI: ",o)}});function _(){t.id=G(this),i(0,t),i(2,l)}return[t,c,l,a,_]}class te extends P{constructor(e){super(),V(this,e,ee,x,$,{})}}function le(f){let e,i,n,t,c;return t=new te({}),{c(){e=v("h1"),i=m("Svelte MIDI Input"),n=D(),U(t.$$.fragment)},l(l){e=b(l,"H1",{});var s=M(e);i=p(s,"Svelte MIDI Input"),s.forEach(h),n=y(l),W(t.$$.fragment,l)},m(l,s){g(l,e,s),d(e,i),g(l,n,s),j(t,l,s),c=!0},p:k,i(l){c||(Q(t.$$.fragment,l),c=!0)},o(l){R(t.$$.fragment,l),c=!1},d(l){l&&h(e),l&&h(n),X(t,l)}}}class oe extends P{constructor(e){super(),V(this,e,null,le,$,{})}}export{oe as default};
