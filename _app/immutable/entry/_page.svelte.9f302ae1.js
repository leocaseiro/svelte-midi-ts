import{S as V,i as $,s as z,k as I,a as L,l as b,m as M,c as S,h,n as N,b as v,G as d,H as D,o as F,e as A,J as H,q as p,r as g,u as k,K as G,L as J,M as q,N as O,O as K,y as U,z as W,A as j,g as Q,d as R,B as X}from"../chunks/index.46f63c5c.js";function T(u,e,i){const n=u.slice();return n[8]=e[i],n}function w(u,e,i){const n=u.slice();return n[11]=e[i],n}function Y(u){let e,i;return{c(){e=I("label"),i=p("No available MIDI inputs"),this.h()},l(n){e=b(n,"LABEL",{for:!0});var t=M(e);i=g(t,"No available MIDI inputs"),t.forEach(h),this.h()},h(){N(e,"for","midi-input-select")},m(n,t){v(n,e,t),d(e,i)},p:D,d(n){n&&h(e)}}}function Z(u){let e,i,n,t,c,l,o=u[2],r=[];for(let s=0;s<o.length;s+=1)r[s]=B(w(u,o,s));return{c(){e=I("label"),i=p("Select MIDI Input:"),n=L(),t=I("select");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){e=b(s,"LABEL",{for:!0});var _=M(e);i=g(_,"Select MIDI Input:"),_.forEach(h),n=S(s),t=b(s,"SELECT",{});var a=M(t);for(let f=0;f<r.length;f+=1)r[f].l(a);a.forEach(h),this.h()},h(){N(e,"for","midi-input-select"),u[0].id===void 0&&J(()=>u[4].call(t))},m(s,_){v(s,e,_),d(e,i),v(s,n,_),v(s,t,_);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(t,null);q(t,u[0].id,!0),c||(l=[O(t,"change",u[4]),O(t,"change",u[3])],c=!0)},p(s,_){if(_&4){o=s[2];let a;for(a=0;a<o.length;a+=1){const f=w(s,o,a);r[a]?r[a].p(f,_):(r[a]=B(f),r[a].c(),r[a].m(t,null))}for(;a<r.length;a+=1)r[a].d(1);r.length=o.length}_&5&&q(t,s[0].id)},d(s){s&&h(e),s&&h(n),s&&h(t),H(r,s),c=!1,K(l)}}}function B(u){let e,i=u[11].name+"",n,t;return{c(){e=I("option"),n=p(i),this.h()},l(c){e=b(c,"OPTION",{});var l=M(e);n=g(l,i),l.forEach(h),this.h()},h(){e.__value=t=u[11].id,e.value=e.__value},m(c,l){v(c,e,l),d(e,n)},p(c,l){l&4&&i!==(i=c[11].name+"")&&k(n,i),l&4&&t!==(t=c[11].id)&&(e.__value=t,e.value=e.__value)},d(c){c&&h(e)}}}function C(u){let e,i=u[1],n=[];for(let t=0;t<i.length;t+=1)n[t]=P(T(u,i,t));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=A()},l(t){for(let c=0;c<n.length;c+=1)n[c].l(t);e=A()},m(t,c){for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(t,c);v(t,e,c)},p(t,c){if(c&2){i=t[1];let l;for(l=0;l<i.length;l+=1){const o=T(t,i,l);n[l]?n[l].p(o,c):(n[l]=P(o),n[l].c(),n[l].m(e.parentNode,e))}for(;l<n.length;l+=1)n[l].d(1);n.length=i.length}},d(t){H(n,t),t&&h(e)}}}function P(u){let e,i,n=u[8].note+"",t,c,l=u[8].timestamp+"",o,r,s=u[8].velocity+"",_;return{c(){e=I("li"),i=p("Note: "),t=p(n),c=p(", Timestamp: "),o=p(l),r=p(", Velocity: "),_=p(s)},l(a){e=b(a,"LI",{});var f=M(e);i=g(f,"Note: "),t=g(f,n),c=g(f,", Timestamp: "),o=g(f,l),r=g(f,", Velocity: "),_=g(f,s),f.forEach(h)},m(a,f){v(a,e,f),d(e,i),d(e,t),d(e,c),d(e,o),d(e,r),d(e,_)},p(a,f){f&2&&n!==(n=a[8].note+"")&&k(t,n),f&2&&l!==(l=a[8].timestamp+"")&&k(o,l),f&2&&s!==(s=a[8].velocity+"")&&k(_,s)},d(a){a&&h(e)}}}function x(u){let e,i,n;function t(r,s){var _;return(_=r[0])!=null&&_.id?Z:Y}let c=t(u),l=c(u),o=u[1].length>0&&C(u);return{c(){e=I("div"),l.c(),i=L(),n=I("ul"),o&&o.c(),this.h()},l(r){e=b(r,"DIV",{});var s=M(e);l.l(s),i=S(s),n=b(s,"UL",{id:!0});var _=M(n);o&&o.l(_),_.forEach(h),s.forEach(h),this.h()},h(){N(n,"id","note-list")},m(r,s){v(r,e,s),l.m(e,null),d(e,i),d(e,n),o&&o.m(n,null)},p(r,[s]){c===(c=t(r))&&l?l.p(r,s):(l.d(1),l=c(r),l&&(l.c(),l.m(e,i))),r[1].length>0?o?o.p(r,s):(o=C(r),o.c(),o.m(n,null)):o&&(o.d(1),o=null)},i:D,o:D,d(r){r&&h(e),l.d(),o&&o.d()}}}function ee(u,e,i){let n,t=null,c=[],l=[];const o=a=>{const f=a.data[0],m=a.timeStamp;if(a.data[1],a.data.length>2&&a.data[2],f<=144&&f<=159){const y=a.data[1],E=a.data[2];i(1,c=[{note:y,timestamp:m,velocity:E},...c])}},r=a=>{t!==a&&(t&&t.removeEventListener("midimessage",o),i(0,t=a),t.addEventListener("midimessage",o))},s=a=>{const f=a.target.value,m=n.inputs.get(f);m&&r(m)};F(async()=>{if(!navigator.requestMIDIAccess){const a="WebMidi API not supported on this browser.";alert(a),console.log(a);return}try{n=await navigator.requestMIDIAccess(),n.onstatechange=a=>{let f=[];n.inputs.forEach(m=>{f.push(m)}),f.length>0?(i(2,l=f.map((m,y)=>{let E=m.name?m.name:m.manufacturer;return E=E??"Midi Input",{id:m.id,name:`${y+1}: ${m.name}`}})),(!t||!f.includes(t))&&r(f[0])):(i(2,l=[{id:"",name:"No available MIDI inputs"}]),i(0,t=null))},n.onstatechange()}catch(a){console.error("Failed to initialize MIDI: ",a)}});function _(){t.id=G(this),i(0,t),i(2,l)}return[t,c,l,s,_]}class te extends V{constructor(e){super(),$(this,e,ee,x,z,{})}}function le(u){let e,i,n,t,c;return t=new te({}),{c(){e=I("h1"),i=p("Svelte MIDI Input"),n=L(),U(t.$$.fragment)},l(l){e=b(l,"H1",{});var o=M(e);i=g(o,"Svelte MIDI Input"),o.forEach(h),n=S(l),W(t.$$.fragment,l)},m(l,o){v(l,e,o),d(e,i),v(l,n,o),j(t,l,o),c=!0},p:D,i(l){c||(Q(t.$$.fragment,l),c=!0)},o(l){R(t.$$.fragment,l),c=!1},d(l){l&&h(e),l&&h(n),X(t,l)}}}class ae extends V{constructor(e){super(),$(this,e,null,le,z,{})}}export{ae as default};
